# Build with AI: SQL Agents with Large Language Models 

Rami Krispin

## SQL Agent Prerequisites: Python, SQL, and LLM Fundamentals Required

To complete this course successfully, you will need knowledge of the following:
- Basic Python programming:
  - Functions and statements
  - Working with libraries and modules
  - DataFrame objects
  - Set and activate a virtual environment
- Basic SQL knowledge
- Basic understanding of what Large Language Models are and their capabilities.

## Python Environment Setup for SQL AI Agents: Complete Installation Guide

Setting a Python environment is crucial for running the code in this course. This section focuses on two approaches to setting a virtual environment:
- Locally with UV
- Using containerized environments (Docker) with VSCode's Dev Containers extension

If you wish to use a different approach for setting up the virtual environment, you can find the required libraries and their versions listed in the `requirements.txt` file under the `docker` folder:

`./docker/requirements.txt`
```
pandas==2.3.1
numpy==2.3.2
plotly==6.2.0
plotly-express==0.4.1
ollama==0.5.3
ipywidgets==8.1.7
jupyter==1.1.1
duckdb==1.3.2
openai==1.99.5 
pointblank==0.12.0
google-genai==1.29.0
anthropic==0.63.0
```

### Setting up a virtual environment with UV

UV is a new Python package and project manager that is extremely fast. If you don't have UV installed, go to the [UV project documentation](https://docs.astral.sh/uv/getting-started/installation/) and follow the installation guide based on your operating system.

>Note that using UV is not a requirement to set up the virtual environment; it is just super fast. If you wish, you can simply use pip instead.

Let's start by setting up the virtual environment with the uv venv command:

```
uv venv sql-ai-venv --python 3.11
```

In this case, we named the virtual environment sql-ai-venv and the Python version as 3.11.

Next, let's activate the virtual environment:
```
source sql-agent-venv/bin/activate
```

Last but not least, let's install the required libraries using the `requirements.txt` file under the `docker` folder:

```
uv pip install --no-cache-dir -r ./docker/requirements.txt
```

You can verify that all the packages were installed by using the following command:
```
uv pip list 
```

Or filter for a specific library with the `grep` command:
```
uv pip list | grep openai
```

This should return the following output:

```
Using Python 3.11.12 environment at: sql-ai-venv
openai                    1.99.5
```

### Setting up a virtual environment with Docker, VSCode, and the Dev Containers extension

In this section, we will walk through the process of setting up the course environment inside a container using Docker and the Dev Containers extension in Visual Studio Code (VS Code).


####  Prerequisites

To launch the course repository inside a container, you will need the following:
- Visual Studio Code (VS Code)
- Docker Desktop
- Docker Hub account
- Dev Containers extension for VS Code


#### Installing Visual Studio Code
- Visit the Visual Studio Code website
- Click the Download button (highlighted in purple in the screenshot).
- Follow the installation instructions for your operating system.

<br>
<figure>
 <img src="assets/vscode.png" width="100%" align="center"/></a>
<figcaption> The OpenAI API Python SDK workflow </figcaption>
</figure>

<br>


#### Installing the Dev Containers Extension

- In VS Code, click the Extensions icon on the left sidebar (purple arrow in the screenshot).
- In the search bar, type Dev Containers (yellow rectangle).
- From the search results, select the extension and review the details.
- Click Install (green rectangle).

<br>
<figure>
 <img src="assets/dev_container_1.png" width="100%" align="center"/></a>
<figcaption> Installing the Dev Containers Extension </figcaption>
</figure>

<br>

#### Installing Docker Desktop
- Visit the Docker website
- Download the appropriate installer for your operating system.
- Follow the installation steps.

<br>
<figure>
 <img src="assets/docker_desktop.png" width="100%" align="center"/></a>
<figcaption> Installing Docker Desktop </figcaption>
</figure>

<br>

> Note: Docker Desktop is free for personal use but requires a license for commercial use. For further information, please refer to https://www.docker.com/pricing/.


#### Creating a Docker Hub Account
To pull the course image, you will need a Docker Hub account.
- Go to the [Docker Hub website](https://hub.docker.com/)
- Click Sign Up and follow the instructions to create your account.


#### Launching the Course Repo in a Container

The course repository includes the following configuration folders:
- `.devcontainer` — Dev Container settings
- `.vscode` — VSCode settings
- `docker` — Docker-specific configuration

<br>
<figure>
 <img src="assets/course_tree.png" width="100%" align="center"/></a>
<figcaption> Course Repository Folders </figcaption>
</figure>

<br>

The `devcontainer.json` file inside the .`devcontainer` folder defines:
- Container settings
- VSCode settings and extensions to install
- Environment variables 

**Step 1: Verify Docker Installation**

Before launching the repository in a container, ensure that Docker Desktop is installed and running in the background. You can confirm this by running the following command:

``` shell
docker --version
```                                                   
A successful installation should return the Docker version and build, for example:
``` shell
Docker version 28.3.3, build 980b856
```

**Step 2: Log in to Docker Hub**

When the Dev Containers extension first launches the repository, it will check for the course image locally. If the image is not found, Docker will attempt to pull it from the default container registry.

To log in to Docker Hub, run:
```shell
docker login
```

If successful, you will see output similar to:

```
Authenticating with existing credentials... [Username: YOUR_USER_NAME]

i Info → To login with a different account, run 'docker logout' followed by 'docker login'


Login Succeeded
```

**Step 3: Open the Repository in a Dev Container**

- Open the course repository folder in VSCode.
- Click the `Open a Remote Window` button (purple in the screenshot below).
- From the Dev Containers menu, select `Reopen in Container` (yellow).

<br>
<figure>
 <img src="assets/dev_container_2.png" width="100%" align="center"/></a>
<figcaption> Installing the Dev Containers Extension </figcaption>
</figure>

<br>

**Step 4: Wait for the Container to Build**

If this is your first time launching the repository, VSCode will download the course image in the background. This may take several minutes.

Once the container is running, you should see:
- A container status indicator next to the `Open a Remote Window` button (purple, below).
- The course container has a Python virtual environment set, and by default, it is activated (`python-3.11-dev`, yellow).

<br>
<figure>
 <img src="assets/dev_container_3.png" width="100%" align="center"/></a>
<figcaption> Installing the Dev Containers Extension </figcaption>
</figure>

<br>


#### Course Image Settings

The course image is published on Docker Hub as: 
```
docker.io/rkrispin/lang-to-sql
```

It is available in two versions:
- `arm64.0.0.1` for machines with ARM processors (e.g., Apple silicon), and
- `amd64.0.0.1` for machines with Intel x86 processors


**Default Configuration**

By default, the `devcontainer.json` file points to the `arm64.0.0.1` image:

```json
{
  "image": "docker.io/rkrispin/lang-to-sql:arm64.0.0.1"
}
```

If you are running on an Intel-based machine, update the image reference to:
```json
{
"image": "docker.io/rkrispin/lang-to-sql:amd64.0.0.1"
}
```

**Docker Configuration Files**

The repository also includes Docker configuration files under the `docker` folder:
- `build_docker.sh` — Bash script to build the Docker image
- `Dockerfile` — Instructions for building the image
- `requirements.txt` — Python dependencies installed in the container










